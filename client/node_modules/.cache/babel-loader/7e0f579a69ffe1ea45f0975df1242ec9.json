{"ast":null,"code":"var _jsxFileName = \"/Users/uayevan/Desktop/ChessApp/client/src/components/Board.js\",\n    _s = $RefreshSig$();\n\nimport React from 'react';\nimport $ from 'jquery';\nimport ChessBoard from './ChessBoard.js';\nimport Chess from 'chess.js';\nimport { useState, useEffect, useContext } from 'react';\nimport { Tab, Tabs, TabList, TabPanel } from 'react-tabs';\nimport { useLocation, Link } from 'react-router-dom';\nimport axios from 'axios';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nfunction Board(props) {\n  _s();\n\n  const [selected, setSelected] = useState('x');\n  const [position, setPosition] = useState('start');\n  const [chess, setChess] = useState(new Chess());\n  const [squareStyles, setSquareStyles] = useState({});\n  const [moves, setMoves] = useState([]);\n  const [positions, setPositions] = useState(['start']);\n  const [positionIndex, setPositionIndex] = useState(0);\n  const [moveable, setMoveable] = useState('false');\n  const [whiteTimer, setWhiteTimer] = useState(props.timer);\n  const [blackTimer, setBlackTimer] = useState(props.timer);\n  const [gameRunning, setGameRunning] = useState('running');\n  const [gameEndReason, setGameEndReason] = useState('');\n\n  const changePosition = index => {\n    if (index >= 0 && index <= positions.length - 1) {\n      setPosition(positions[index]);\n      setPositionIndex(index);\n      if (positions[index] === positions[positions.length - 1]) setMoveable('true');else setMoveable('false');\n    }\n  };\n\n  const convertToTuples = array => {\n    //[a, b, c, d, e] => [[a, b], [c, d], [e]]\n    var newArray = [];\n\n    for (var i = 0; i < array.length; i = i + 2) {\n      if (i >= array.length) break;else if (i + 1 < array.length) {\n        newArray.push([array[i], array[i + 1]]);\n      } else {\n        newArray.push([array[i]]);\n      }\n    }\n\n    return newArray;\n  };\n\n  const move = theMove => {\n    if (moveable) {\n      console.log(theMove);\n      chess.move({\n        from: theMove.sourceSquare,\n        to: theMove.targetSquare\n      });\n      setMoves(convertToTuples(chess.history()));\n      var newArray = positions;\n      newArray.push(chess.fen());\n      setPositions(newArray);\n      setPositionIndex(positionIndex + 1);\n      setPosition(chess.fen());\n\n      if (chess.turn() === \"b\") {\n        setWhiteTimer(whiteTimer + 2);\n      } else {\n        setBlackTimer(blackTimer + 2);\n      }\n    }\n  };\n\n  const movePiece = square => {\n    if (moveable) {\n      if (chess.get(square) && chess.get(square).color === chess.turn()) {\n        setSelected(square);\n        let highlightedSquares = {};\n        highlightedSquares[square] = {\n          backgroundColor: \"#0000ff\"\n        };\n        let moves = chess.moves({\n          square: square,\n          verbose: true\n        });\n\n        if (moves.length === 0) {\n          setSelected('x');\n          setSquareStyles({});\n          return;\n        }\n\n        let squaresToHighlight = [];\n\n        for (var i = 0; i < moves.length; i++) {\n          squaresToHighlight.push(moves[i].to);\n        }\n\n        for (var i = 0; i < squaresToHighlight.length; i++) {\n          highlightedSquares[squaresToHighlight[i]] = {\n            background: \"radial-gradient(circle, #0000ff 20%, transparent 40%)\",\n            borderRadius: \"50%\"\n          };\n        }\n\n        setSquareStyles(highlightedSquares);\n      } else if (selected !== 'x') {\n        setSelected('x');\n        setSquareStyles({});\n        chess.move({\n          from: selected,\n          to: square\n        });\n        setMoves(convertToTuples(chess.history()));\n        var newArray = positions;\n        newArray.push(chess.fen());\n        setPositions(newArray);\n        setPositionIndex(positionIndex + 1);\n        changePosition(newArray.length - 1);\n\n        if (chess.turn() === \"b\") {\n          setTimeout(() => setWhiteTimer(whiteTimer + parseInt(props.increment)), 1000);\n        } else {\n          setTimeout(() => setBlackTimer(blackTimer + parseInt(props.increment)), 1000);\n        }\n      }\n    }\n  };\n\n  const formatTime = stopwatch => {\n    var time = new Date(stopwatch * 1000).toISOString().substr(14, 5);\n    return time;\n  };\n\n  useEffect(() => {\n    if (whiteTimer > 0 && blackTimer > 0 && chess.in_checkmate() === false && chess.in_threefold_repetition() === false && chess.in_stalemate() === false) {\n      if (chess.turn() === \"w\") {\n        setTimeout(() => setWhiteTimer(whiteTimer - 1), 1000);\n      } else {\n        setTimeout(() => setBlackTimer(blackTimer - 1), 1000);\n      }\n    } else {\n      if (chess.in_checkmate() === true) {\n        if (chess.turn() === 'w') setGameRunning('Black');else setGameRunning('White');\n        setGameEndReason('checkmate');\n      } else if (chess.in_stalemate() === true) {\n        if (chess.turn() === 'w') setGameRunning('Black');else setGameRunning('White');\n        setGameEndReason('stalemate');\n      } else if (chess.in_threefold_repetition() === true) {\n        if (chess.turn() === 'w') setGameRunning('Black');else setGameRunning('White');\n        setGameEndReason('threefold repetition');\n      } else if (whiteTimer <= 0) {\n        setGameRunning('Black');\n        setGameEndReason('timeout');\n      } else if (blackTimer <= 0) {\n        setGameRunning('White');\n        setGameEndReason('timeout');\n      }\n    }\n  });\n  return /*#__PURE__*/_jsxDEV(\"body\", {\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      children: /*#__PURE__*/_jsxDEV(ChessBoard, {\n        orientation: props.color,\n        width: 600,\n        position: position,\n        onDrop: move,\n        onSquareClick: movePiece,\n        squareStyles: squareStyles\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 176,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 175,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        position: 'absolute',\n        backgroundColor: 'white',\n        fontSize: '36px',\n        width: '140px',\n        textAlign: 'right',\n        borderRadius: '6px',\n        left: '460px',\n        top: '624px'\n      },\n      children: props.color === \"white\" ? formatTime(whiteTimer) : formatTime(blackTimer)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 179,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        position: 'absolute',\n        backgroundColor: 'white',\n        fontSize: '36px',\n        width: '140px',\n        textAlign: 'right',\n        borderRadius: '6px',\n        left: '460px',\n        top: '-30px'\n      },\n      children: props.color === \"white\" ? formatTime(blackTimer) : formatTime(whiteTimer)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 188,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        overflow: 'scroll',\n        display: 'inline-block',\n        height: '600px',\n        width: '200px',\n        position: 'absolute',\n        top: '20px',\n        right: '-250px',\n        color: 'white',\n        backgroundColor: 'black'\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          width: 'auto',\n          textAlign: 'center',\n          fontSize: '24px'\n        },\n        children: \"Game Moves\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 199,\n        columnNumber: 17\n      }, this), moves.map((move, i) => /*#__PURE__*/_jsxDEV(\"p\", {\n        style: {\n          display: 'flex',\n          justifyContent: 'space-between',\n          width: '160px'\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"span\", {\n          style: {\n            position: 'absolute',\n            left: '0px'\n          },\n          children: [\"\\xA0\", i + 1]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 204,\n          columnNumber: 29\n        }, this), positionIndex === 2 * i + 1 ? /*#__PURE__*/_jsxDEV(\"span\", {\n          onClick: () => changePosition(2 * i + 1),\n          style: {\n            position: 'absolute',\n            left: '40px',\n            backgroundColor: 'white',\n            color: 'black'\n          },\n          children: move[0]\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 206,\n          columnNumber: 33\n        }, this) : /*#__PURE__*/_jsxDEV(\"span\", {\n          onClick: () => changePosition(2 * i + 1),\n          style: {\n            position: 'absolute',\n            left: '40px'\n          },\n          children: move[0]\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 208,\n          columnNumber: 33\n        }, this), positionIndex === 2 * i + 2 ? /*#__PURE__*/_jsxDEV(\"span\", {\n          onClick: () => changePosition(2 * i + 2),\n          style: {\n            position: 'absolute',\n            left: '120px',\n            backgroundColor: 'white',\n            color: 'black'\n          },\n          children: move[1]\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 211,\n          columnNumber: 33\n        }, this) : /*#__PURE__*/_jsxDEV(\"span\", {\n          onClick: () => changePosition(2 * i + 2),\n          style: {\n            position: 'absolute',\n            left: '120px'\n          },\n          children: move[1]\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 213,\n          columnNumber: 33\n        }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 216,\n          columnNumber: 29\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 203,\n        columnNumber: 25\n      }, this))]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 198,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        textAlign: 'center',\n        backgroundColor: 'white',\n        width: '200px',\n        position: 'absolute',\n        top: '620px',\n        right: '-250px',\n        height: '40px'\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"span\", {\n        onClick: () => changePosition(0),\n        style: {\n          fontSize: '36px'\n        },\n        children: \"\\xAB\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 222,\n        columnNumber: 17\n      }, this), \"\\xA0 \\xA0\", /*#__PURE__*/_jsxDEV(\"span\", {\n        onClick: () => changePosition(positionIndex - 1),\n        style: {\n          fontSize: '36px'\n        },\n        children: \"<\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 225,\n        columnNumber: 17\n      }, this), \"\\xA0 \\xA0 \\xA0\", /*#__PURE__*/_jsxDEV(\"span\", {\n        onClick: () => changePosition(positionIndex + 1),\n        style: {\n          fontSize: '36px'\n        },\n        children: \">\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 229,\n        columnNumber: 17\n      }, this), \"\\xA0 \\xA0\", /*#__PURE__*/_jsxDEV(\"span\", {\n        onClick: () => changePosition(positions.length - 1),\n        style: {\n          fontSize: '36px'\n        },\n        children: \"\\xBB\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 232,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 221,\n      columnNumber: 13\n    }, this), gameRunning !== 'running' ? gameEndReason === 'checkmate' || gameEndReason === 'timeout' ? /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        position: 'absolute',\n        fontSize: '36px',\n        backgroundColor: 'white',\n        bottom: '-100px',\n        borderRadius: '8px'\n      },\n      children: [gameRunning, \" won the game by \", gameEndReason, \"!\"]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 237,\n      columnNumber: 25\n    }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        position: 'absolute',\n        fontSize: '36px',\n        backgroundColor: 'white',\n        bottom: '-100px',\n        borderRadius: '8px'\n      },\n      children: [\"Game ended in a draw by \", gameEndReason]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 243,\n      columnNumber: 25\n    }, this) : null]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 174,\n    columnNumber: 9\n  }, this);\n}\n\n_s(Board, \"L7EeHjoFynIxicnlZP089XV4xj0=\");\n\n_c = Board;\nexport default Board;\n\nvar _c;\n\n$RefreshReg$(_c, \"Board\");","map":{"version":3,"sources":["/Users/uayevan/Desktop/ChessApp/client/src/components/Board.js"],"names":["React","$","ChessBoard","Chess","useState","useEffect","useContext","Tab","Tabs","TabList","TabPanel","useLocation","Link","axios","Board","props","selected","setSelected","position","setPosition","chess","setChess","squareStyles","setSquareStyles","moves","setMoves","positions","setPositions","positionIndex","setPositionIndex","moveable","setMoveable","whiteTimer","setWhiteTimer","timer","blackTimer","setBlackTimer","gameRunning","setGameRunning","gameEndReason","setGameEndReason","changePosition","index","length","convertToTuples","array","newArray","i","push","move","theMove","console","log","from","sourceSquare","to","targetSquare","history","fen","turn","movePiece","square","get","color","highlightedSquares","backgroundColor","verbose","squaresToHighlight","background","borderRadius","setTimeout","parseInt","increment","formatTime","stopwatch","time","Date","toISOString","substr","in_checkmate","in_threefold_repetition","in_stalemate","fontSize","width","textAlign","left","top","overflow","display","height","right","map","justifyContent","bottom"],"mappings":"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","sourcesContent":["import React from 'react';\nimport $ from 'jquery'\nimport ChessBoard from './ChessBoard.js'\nimport Chess from 'chess.js'\nimport { useState, useEffect, useContext } from 'react';\nimport { Tab, Tabs, TabList, TabPanel } from 'react-tabs';\nimport { useLocation, Link } from 'react-router-dom';\nimport axios from 'axios';\n\nfunction Board(props) {\n    const [selected, setSelected] = useState('x')\n    const [position, setPosition] = useState('start')\n    const [chess, setChess] = useState(new Chess())\n    const [squareStyles, setSquareStyles] = useState({})\n    const [moves, setMoves] = useState([])\n    const [positions, setPositions] = useState(['start'])\n    const [positionIndex, setPositionIndex] = useState(0)\n    const [moveable, setMoveable] = useState('false')\n    const [whiteTimer, setWhiteTimer] = useState(props.timer)\n    const [blackTimer, setBlackTimer] = useState(props.timer)\n    const [gameRunning, setGameRunning] = useState('running')\n    const [gameEndReason, setGameEndReason] = useState('')\n\n\n    const changePosition = (index) => {\n        if(index >= 0 && index <= positions.length - 1)\n        {\n            setPosition(positions[index]);\n            setPositionIndex(index);\n            if(positions[index] === positions[positions.length - 1])\n                setMoveable('true')\n            else\n                setMoveable('false')\n        }\n    }\n\n    const convertToTuples = (array) => {\n        //[a, b, c, d, e] => [[a, b], [c, d], [e]]\n        var newArray = [];\n        for(var i = 0; i < array.length; i=i+2) {\n            if(i >= array.length)\n                break;\n            else if(i + 1 < array.length) {\n                newArray.push([array[i], array[i+1]])\n            }\n            else {\n                newArray.push([array[i]])\n            }\n        }\n        return newArray;\n    }\n    const move = (theMove) => {\n        if(moveable) {\n            console.log(theMove)\n            chess.move({from: theMove.sourceSquare, to: theMove.targetSquare})\n            setMoves(convertToTuples(chess.history()))\n            var newArray = positions\n            newArray.push(chess.fen())\n            setPositions(newArray)\n            setPositionIndex(positionIndex + 1);\n            setPosition(chess.fen())\n            if(chess.turn() === \"b\") {\n                setWhiteTimer(whiteTimer + 2)\n            }\n            else {\n                setBlackTimer(blackTimer + 2)\n            }\n        }\n    }\n\n    const movePiece = (square) => {\n        if(moveable) {\n            if(chess.get(square) && chess.get(square).color === chess.turn()) {\n                setSelected(square)\n                let highlightedSquares = {};\n                highlightedSquares[square] = \n                {\n                    backgroundColor: \"#0000ff\"\n                }\n                let moves = chess.moves({\n                    square: square,\n                    verbose: true\n                });\n                if (moves.length === 0) {\n                    setSelected('x');\n                    setSquareStyles({})\n                    return;\n                }\n            \n                let squaresToHighlight = [];\n                for (var i = 0; i < moves.length; i++) {\n                    squaresToHighlight.push(moves[i].to);\n                }\n                for(var i = 0; i < squaresToHighlight.length; i ++) {\n                    highlightedSquares[squaresToHighlight[i]] = \n                    {\n                        background:\n                        \"radial-gradient(circle, #0000ff 20%, transparent 40%)\",\n                        borderRadius: \"50%\"\n                    }\n                }\n                setSquareStyles(highlightedSquares)\n            }\n            else if(selected !== 'x') {\n                setSelected('x');\n                setSquareStyles({});\n                chess.move({from: selected, to: square});\n                setMoves(convertToTuples(chess.history()));\n                var newArray = positions;\n                newArray.push(chess.fen());\n                setPositions(newArray);\n                setPositionIndex(positionIndex + 1);\n                changePosition(newArray.length - 1);\n                if(chess.turn() === \"b\") {\n                    setTimeout(() => setWhiteTimer(whiteTimer + parseInt(props.increment)), 1000)\n                }\n                else {\n                    setTimeout(() => setBlackTimer(blackTimer + parseInt(props.increment)), 1000)\n                }\n            }\n        }\n    }\n\n    const formatTime = (stopwatch) => {\n        var time = new Date(stopwatch * 1000).toISOString().substr(14, 5);\n        return time;\n    }\n\n    useEffect(() => {\n        if(whiteTimer > 0 && blackTimer > 0 && chess.in_checkmate() === false && \n        chess.in_threefold_repetition() === false && chess.in_stalemate() === false) {\n            if(chess.turn() === \"w\") {\n                setTimeout(() => setWhiteTimer(whiteTimer - 1), 1000)\n            }\n            else {\n                setTimeout(() => setBlackTimer(blackTimer - 1), 1000)\n            }\n        }\n        else {\n            if(chess.in_checkmate() === true) {\n                if(chess.turn() === 'w')\n                    setGameRunning('Black')\n                else\n                    setGameRunning('White')\n                setGameEndReason('checkmate')\n            }\n            else if(chess.in_stalemate() === true) {\n                if(chess.turn() === 'w')\n                    setGameRunning('Black')\n                else\n                    setGameRunning('White')\n                setGameEndReason('stalemate')\n            }\n            else if(chess.in_threefold_repetition() === true) {\n                if(chess.turn() === 'w')\n                    setGameRunning('Black')\n                else\n                    setGameRunning('White')\n                setGameEndReason('threefold repetition')\n\n            }\n            else if(whiteTimer <= 0) {\n                setGameRunning('Black')\n                setGameEndReason('timeout')\n            }\n            else if(blackTimer <= 0) {\n                setGameRunning('White')\n                setGameEndReason('timeout')\n            }\n        }\n    })\n\n    return(\n        <body>\n            <div>\n                <ChessBoard orientation={props.color} width={600} \n                position={position} onDrop={move} onSquareClick={movePiece} squareStyles={squareStyles}/>                 \n            </div>\n            <div style={{position: 'absolute', backgroundColor: 'white', \n            fontSize: '36px', width: '140px', textAlign: 'right',\n            borderRadius: '6px', left: '460px', top: '624px'}}>\n                {   props.color === \"white\" ?\n                        formatTime(whiteTimer)\n                        :\n                        formatTime(blackTimer)\n                }\n            </div>\n            <div style={{position: 'absolute', backgroundColor: 'white', \n            fontSize: '36px', width: '140px', textAlign: 'right',\n            borderRadius: '6px', left: '460px', top: '-30px'}}>\n                {   props.color === \"white\" ?\n                        formatTime(blackTimer)\n                        :\n                        formatTime(whiteTimer)\n                }\n            </div>\n            \n            <div style={{overflow: 'scroll', display: 'inline-block', height: '600px', width: '200px', position: 'absolute', top: '20px', right: '-250px', color: 'white', backgroundColor: 'black'}}>\n                <div style={{width: 'auto', textAlign: 'center', fontSize: '24px'}}>Game Moves</div>\n                \n                {\n                    moves.map((move, i) => (\n                        <p style={{display: 'flex', justifyContent: 'space-between', width: '160px'}}>\n                            <span style={{position: 'absolute', left: '0px'}}>&nbsp;{i+1}</span>\n                            {positionIndex === 2*i + 1 ? \n                                <span onClick={() => changePosition(2*i + 1)} style={{position: 'absolute', left: '40px', backgroundColor: 'white', color: 'black'}}>{move[0]}</span>\n                                :\n                                <span onClick={() => changePosition(2*i + 1)} style={{position: 'absolute', left: '40px'}}>{move[0]}</span>\n                            }\n                            {positionIndex === 2*i + 2 ?\n                                <span onClick={() => changePosition(2*i + 2)} style={{position: 'absolute', left: '120px', backgroundColor: 'white', color: 'black'}}>{move[1]}</span>\n                                :\n                                <span onClick={() => changePosition(2*i + 2)} style={{position: 'absolute', left: '120px'}}>{move[1]}</span>\n                            }\n \n                            <br/>\n                        </p>\n                    ))\n                }\n            </div>\n            <div style={{textAlign: 'center', backgroundColor: 'white', width: '200px', position: 'absolute', top: '620px', right: '-250px', height: '40px'}}>\n                <span onClick={() => changePosition(0)} style={{fontSize: '36px'}}>&laquo;</span>\n                &nbsp;\n                &nbsp;\n                <span onClick={() => changePosition(positionIndex - 1)} style={{fontSize: '36px'}}>&lt;</span>\n                &nbsp;\n                &nbsp;\n                &nbsp;\n                <span onClick={() => changePosition(positionIndex + 1)} style={{fontSize: '36px'}}>&gt;</span>\n                &nbsp;\n                &nbsp;\n                <span onClick={() => changePosition(positions.length - 1)} style={{fontSize: '36px'}}>&raquo;</span>\n            </div>\n            {\n                gameRunning !== 'running' ?\n                    gameEndReason === 'checkmate' || gameEndReason === 'timeout' ?\n                        <div style={{position: 'absolute', fontSize: '36px', \n                        backgroundColor: 'white', bottom: '-100px', \n                        borderRadius: '8px'}}>\n                            {gameRunning} won the game by {gameEndReason}!\n                            </div>\n                        :\n                        <div style={{position: 'absolute', fontSize: '36px', \n                        backgroundColor: 'white', bottom: '-100px', \n                        borderRadius: '8px'}}>\n                            Game ended in a draw by {gameEndReason}\n                            </div>\n                    :\n                    null\n            }\n        </body>\n    );\n}\n\nexport default Board;\n"]},"metadata":{},"sourceType":"module"}